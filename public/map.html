<!DOCTYPE html>
<html>
<head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>

            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_8ba4d87378bad3cbe14f63c3d60b68b4 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>


    <script src="https://cdn.jsdelivr.net/gh/python-visualization/folium@main/folium/templates/leaflet_heat.min.js"></script>
</head>
<body>


            <div class="folium-map" id="map_8ba4d87378bad3cbe14f63c3d60b68b4" ></div>

</body>


<script>


            var map_8ba4d87378bad3cbe14f63c3d60b68b4 = L.map(
                "map_8ba4d87378bad3cbe14f63c3d60b68b4",
                {
                    center: [32.0, 35.0],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 10,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );





            var tile_layer_eb814afac1ba2feba1340b506d505a41 = L.tileLayer(
                "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
  "minZoom": 0,
  "maxZoom": 19,
  "maxNativeZoom": 19,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );


            tile_layer_eb814afac1ba2feba1340b506d505a41.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);


            var tile_layer_4d62165eb087c597c86c1b5035a9c3f7 = L.tileLayer(
                "https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",
                {
  "minZoom": 0,
  "maxZoom": 18,
  "maxNativeZoom": 18,
  "noWrap": false,
  "attribution": "Esri",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );


            tile_layer_4d62165eb087c597c86c1b5035a9c3f7.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);


            var feature_group_b96396251f75167972efd5cffa6cfee8 = L.featureGroup(
                {
}
            );


            var marker_51674ce447fa2244f02bafed61987e99 = L.marker(
                [32.1, 35.0],
                {
}
            ).addTo(feature_group_b96396251f75167972efd5cffa6cfee8);


            var icon_6c87e637ef262ffb3ad2cc4098ead19a = L.AwesomeMarkers.icon(
                {
  "markerColor": "green",
  "iconColor": "white",
  "icon": "shield-heart",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_95b620c032898f2edec1a0fd6d68540d = L.popup({
  "maxWidth": 200,
});



                var html_acd00271069bb9f2878eaaf5c115963f = $(`<div id="html_acd00271069bb9f2878eaaf5c115963f" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #28A745;         font-weight: bold;         font-size: 14px;         ">Bunker       </div></div>`)[0];
                popup_95b620c032898f2edec1a0fd6d68540d.setContent(html_acd00271069bb9f2878eaaf5c115963f);



        marker_51674ce447fa2244f02bafed61987e99.bindPopup(popup_95b620c032898f2edec1a0fd6d68540d)
        ;




                marker_51674ce447fa2244f02bafed61987e99.setIcon(icon_6c87e637ef262ffb3ad2cc4098ead19a);


            var marker_b11409d431b0653da274f9f1a0292680 = L.marker(
                [32.1, 35.2],
                {
}
            ).addTo(feature_group_b96396251f75167972efd5cffa6cfee8);


            var icon_3c6fa3e532f9667ab74a160fdd5e3ebc = L.AwesomeMarkers.icon(
                {
  "markerColor": "green",
  "iconColor": "white",
  "icon": "shield-heart",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_94818aebc924a3229cd778ab21e99382 = L.popup({
  "maxWidth": 200,
});



                var html_e2ead2d802baab5ec88902aa6e07ddbb = $(`<div id="html_e2ead2d802baab5ec88902aa6e07ddbb" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #28A745;         font-weight: bold;         font-size: 14px;         ">Safe Location       </div></div>`)[0];
                popup_94818aebc924a3229cd778ab21e99382.setContent(html_e2ead2d802baab5ec88902aa6e07ddbb);



        marker_b11409d431b0653da274f9f1a0292680.bindPopup(popup_94818aebc924a3229cd778ab21e99382)
        ;




                marker_b11409d431b0653da274f9f1a0292680.setIcon(icon_3c6fa3e532f9667ab74a160fdd5e3ebc);


            var marker_4abb475aacae0f6b04b08e297a0f33cc = L.marker(
                [32.2, 35.0],
                {
}
            ).addTo(feature_group_b96396251f75167972efd5cffa6cfee8);


            var icon_f1ba1e763a70f7435638fc7b104026e8 = L.AwesomeMarkers.icon(
                {
  "markerColor": "green",
  "iconColor": "white",
  "icon": "shield-heart",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_50cb25ab76cb9e88425281f78861991c = L.popup({
  "maxWidth": 200,
});



                var html_c33fe7f22361c0c826755e69e6738a3d = $(`<div id="html_c33fe7f22361c0c826755e69e6738a3d" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #28A745;         font-weight: bold;         font-size: 14px;         ">Shelter       </div></div>`)[0];
                popup_50cb25ab76cb9e88425281f78861991c.setContent(html_c33fe7f22361c0c826755e69e6738a3d);



        marker_4abb475aacae0f6b04b08e297a0f33cc.bindPopup(popup_50cb25ab76cb9e88425281f78861991c)
        ;




                marker_4abb475aacae0f6b04b08e297a0f33cc.setIcon(icon_f1ba1e763a70f7435638fc7b104026e8);


            var marker_7419956eaad8efb470d1e6aa422392f9 = L.marker(
                [32.3, 35.1],
                {
}
            ).addTo(feature_group_b96396251f75167972efd5cffa6cfee8);


            var icon_2382d254de9cb9cea876841eda1e83f6 = L.AwesomeMarkers.icon(
                {
  "markerColor": "green",
  "iconColor": "white",
  "icon": "shield-heart",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_d183904afddbe66e6722e7eb6973f018 = L.popup({
  "maxWidth": 200,
});



                var html_65ca00695f549222ab5613cb3e8cc652 = $(`<div id="html_65ca00695f549222ab5613cb3e8cc652" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #28A745;         font-weight: bold;         font-size: 14px;         ">Food Bank       </div></div>`)[0];
                popup_d183904afddbe66e6722e7eb6973f018.setContent(html_65ca00695f549222ab5613cb3e8cc652);



        marker_7419956eaad8efb470d1e6aa422392f9.bindPopup(popup_d183904afddbe66e6722e7eb6973f018)
        ;




                marker_7419956eaad8efb470d1e6aa422392f9.setIcon(icon_2382d254de9cb9cea876841eda1e83f6);


            feature_group_b96396251f75167972efd5cffa6cfee8.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);


            var feature_group_3b32d4f49717e9a42f5feb6bba4d50f9 = L.featureGroup(
                {
}
            );


            var heat_map_79b774ca508734a281d4fcb27842d4a1 = L.heatLayer(
                [[32.3, 35.2, 0.1], [32.2, 35.1, 0.5], [32.1, 35.0, 0.6], [32.0, 34.9, 0.7]],
                {
  "minOpacity": 0.5,
  "maxZoom": 18,
  "radius": 20,
  "blur": 50,
}
            );


            heat_map_79b774ca508734a281d4fcb27842d4a1.addTo(feature_group_3b32d4f49717e9a42f5feb6bba4d50f9);


            feature_group_3b32d4f49717e9a42f5feb6bba4d50f9.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);


            var feature_group_dc9312a51169630a5b13ee279242dfdd = L.featureGroup(
                {
}
            );


            var marker_81ed6a82cc99b284d2336e88b1bca3e8 = L.marker(
                [32.3, 35.2],
                {
}
            ).addTo(feature_group_dc9312a51169630a5b13ee279242dfdd);


            var icon_f71799bca14227b427626c58ecbdfea2 = L.AwesomeMarkers.icon(
                {
  "markerColor": "red",
  "iconColor": "white",
  "icon": "skull-crossbones",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_3f88f84de3a8010cf38d8fc99b141550 = L.popup({
  "maxWidth": 200,
});



                var html_5ddede9da6751117279d31d43f977563 = $(`<div id="html_5ddede9da6751117279d31d43f977563" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #b22222;         font-weight: bold;         font-size: 14px;         ">Bomb       </div></div>`)[0];
                popup_3f88f84de3a8010cf38d8fc99b141550.setContent(html_5ddede9da6751117279d31d43f977563);



        marker_81ed6a82cc99b284d2336e88b1bca3e8.bindPopup(popup_3f88f84de3a8010cf38d8fc99b141550)
        ;




                marker_81ed6a82cc99b284d2336e88b1bca3e8.setIcon(icon_f71799bca14227b427626c58ecbdfea2);


            var marker_d04065c508cdac3b5111c9c7763ca6c8 = L.marker(
                [32.2, 35.1],
                {
}
            ).addTo(feature_group_dc9312a51169630a5b13ee279242dfdd);


            var icon_98c11320fb3b62398742be27f5fe4eb5 = L.AwesomeMarkers.icon(
                {
  "markerColor": "red",
  "iconColor": "white",
  "icon": "skull-crossbones",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_bfebd14fcfff748b44930e065d7e5c3f = L.popup({
  "maxWidth": 200,
});



                var html_5c5bcbbb89c28b93344ffa533254379b = $(`<div id="html_5c5bcbbb89c28b93344ffa533254379b" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #b22222;         font-weight: bold;         font-size: 14px;         ">Car Explosion       </div></div>`)[0];
                popup_bfebd14fcfff748b44930e065d7e5c3f.setContent(html_5c5bcbbb89c28b93344ffa533254379b);



        marker_d04065c508cdac3b5111c9c7763ca6c8.bindPopup(popup_bfebd14fcfff748b44930e065d7e5c3f)
        ;




                marker_d04065c508cdac3b5111c9c7763ca6c8.setIcon(icon_98c11320fb3b62398742be27f5fe4eb5);


            var marker_1b1021efbda8aa693082a710b0f07eee = L.marker(
                [32.1, 35.0],
                {
}
            ).addTo(feature_group_dc9312a51169630a5b13ee279242dfdd);


            var icon_d50757c088bdd53c7833ebf9bd452fa2 = L.AwesomeMarkers.icon(
                {
  "markerColor": "red",
  "iconColor": "white",
  "icon": "skull-crossbones",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_0d033a32d0852c12a08c173005e35144 = L.popup({
  "maxWidth": 200,
});



                var html_7dfb2a67d46a83528cbf33e32b43a928 = $(`<div id="html_7dfb2a67d46a83528cbf33e32b43a928" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #b22222;         font-weight: bold;         font-size: 14px;         ">Drone Attackkw4e flaweh lghasdk guoasdh giadh daj gbadfgh adfg hkdfj gasdhig lasdlg adfjg ldf       </div></div>`)[0];
                popup_0d033a32d0852c12a08c173005e35144.setContent(html_7dfb2a67d46a83528cbf33e32b43a928);



        marker_1b1021efbda8aa693082a710b0f07eee.bindPopup(popup_0d033a32d0852c12a08c173005e35144)
        ;




                marker_1b1021efbda8aa693082a710b0f07eee.setIcon(icon_d50757c088bdd53c7833ebf9bd452fa2);


            var marker_5691ebbdee8f5bd8d04ef15010a76e1a = L.marker(
                [32.0, 34.9],
                {
}
            ).addTo(feature_group_dc9312a51169630a5b13ee279242dfdd);


            var icon_c971e1b374c77b25faddc4367d4f51e1 = L.AwesomeMarkers.icon(
                {
  "markerColor": "red",
  "iconColor": "white",
  "icon": "skull-crossbones",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_dca0e4bc4c28c43499b4f5e779f3fdcb = L.popup({
  "maxWidth": 200,
});



                var html_36754d7e10a433957703da085c74ed99 = $(`<div id="html_36754d7e10a433957703da085c74ed99" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #b22222;         font-weight: bold;         font-size: 14px;         ">Air Strike       </div></div>`)[0];
                popup_dca0e4bc4c28c43499b4f5e779f3fdcb.setContent(html_36754d7e10a433957703da085c74ed99);



        marker_5691ebbdee8f5bd8d04ef15010a76e1a.bindPopup(popup_dca0e4bc4c28c43499b4f5e779f3fdcb)
        ;




                marker_5691ebbdee8f5bd8d04ef15010a76e1a.setIcon(icon_c971e1b374c77b25faddc4367d4f51e1);


            feature_group_dc9312a51169630a5b13ee279242dfdd.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);


            var feature_group_a70a1e2e5abcd4cfe6cfbf527f528cf8 = L.featureGroup(
                {
}
            );


            var marker_2d99df24cd6cd3c9690242c062403abd = L.marker(
                [32.0737, 34.7744],
                {
}
            ).addTo(feature_group_a70a1e2e5abcd4cfe6cfbf527f528cf8);


            var icon_589f644033b43759b5b9372efaab3f68 = L.AwesomeMarkers.icon(
                {
  "markerColor": "blue",
  "iconColor": "white",
  "icon": "landmark",
  "prefix": "fa",
  "extraClasses": "fa-rotate-0",
}
            );


        var popup_b6b20b6112d27c82184abdc7fd4a8db4 = L.popup({
  "maxWidth": 200,
});



                var html_e9eeed5bcde5d3e242888a32fadb03e0 = $(`<div id="html_e9eeed5bcde5d3e242888a32fadb03e0" style="width: 100.0%; height: 100.0%;">       <div style="         font-family: Arial, sans-serif;         color: #28A745;         font-weight: bold;         font-size: 14px;         ">Tel Aviv Embassy       </div></div>`)[0];
                popup_b6b20b6112d27c82184abdc7fd4a8db4.setContent(html_e9eeed5bcde5d3e242888a32fadb03e0);



        marker_2d99df24cd6cd3c9690242c062403abd.bindPopup(popup_b6b20b6112d27c82184abdc7fd4a8db4)
        ;




                marker_2d99df24cd6cd3c9690242c062403abd.setIcon(icon_589f644033b43759b5b9372efaab3f68);


            feature_group_a70a1e2e5abcd4cfe6cfbf527f528cf8.addTo(map_8ba4d87378bad3cbe14f63c3d60b68b4);
            function updateParentStatus(zoom, center, scale) {
                // Send message to parent window
                if (window.parent && window.parent !== window) {
                    window.parent.postMessage({
                        type: 'mapUpdate',
                        zoom: zoom,
                        lat: center.lat,
                        lng: center.lng,
                        scale: scale
                    }, '*');
                }
            }
            function updateParentStatus(zoom, center, scale) {
                if (window.parent && window.parent !== window) {
                    window.parent.postMessage({
                        type: 'mapUpdate',
                        zoom: zoom,
                        lat: center.lat,
                        lng: center.lng,
                        scale: scale
                    }, '*');
                }
            }

            function calculateScale(zoom) {
                const earthCircumference = 40075016.686; // meters
                const tileSize = 256; // pixels
                const scale = earthCircumference / (tileSize * Math.pow(2, zoom));

                if (scale >= 1000000) {
                    return `1:${Math.round(scale / 1000000)}M`;
                } else if (scale >= 1000) {
                    return `1:${Math.round(scale / 1000)}K`;
                } else {
                    return `1:${Math.round(scale)}`;
                }
            }

            // Add event listeners to the map
            if (typeof map_8ba4d87378bad3cbe14f63c3d60b68b4 !== 'undefined') {
                const map = map_8ba4d87378bad3cbe14f63c3d60b68b4;

                // Listen for zoom changes
                map.on('zoomend', function() {
                    const zoom = map.getZoom();
                    const center = map.getCenter();
                    const scale = calculateScale(zoom);
                    updateParentStatus(zoom, center, scale);
                });

                // Listen for pan/move changes
                map.on('moveend', function() {
                    const zoom = map.getZoom();
                    const center = map.getCenter();
                    const scale = calculateScale(zoom);
                    updateParentStatus(zoom, center, scale);
                });

                // Send initial values when map loads
                setTimeout(() => {
                    const zoom = map.getZoom();
                    const center = map.getCenter();
                    const scale = calculateScale(zoom);
                    updateParentStatus(zoom, center, scale);
                }, 1000);
            }

            function updateStatusBar(data) {
                console.log('Updating status bar with:', data);

                // Find status panels by their position
                const statusPanels = document.querySelectorAll('.status-panel');

                if (statusPanels.length >= 4) {
                    // Update coordinates (second panel)
                    const coordElement = statusPanels[1];
                    if (coordElement) {
                        coordElement.textContent = `Coordinates: ${data.lat.toFixed(4)}° N, ${data.lng.toFixed(4)}° W`;
                    }

                    // Update zoom (third panel) - convert Leaflet zoom to percentage
                    const zoomElement = statusPanels[2];
                    if (zoomElement) {
                        const zoomPercent = Math.round(((data.zoom + 2) / 20) * 400); // Rough conversion
                        zoomElement.textContent = `Zoom: ${zoomPercent}%`;
                    }

                    // Update scale (fourth panel)
                    const scaleElement = statusPanels[3];
                    if (scaleElement) {
                        scaleElement.textContent = `Scale: ${data.scale}`;
                    }
                }
            }

            // Listen for messages from the map iframe
            window.addEventListener('message', function(event) {
                // Check if message is from our map
                if (event.data && event.data.type === 'mapUpdate') {
                    console.log('Received map update:', event.data);
                    updateStatusBar(event.data);
                }
            });

            // Debug function to test the connection
            function testMapConnection() {
                console.log('Testing map connection...');
                const iframe = document.querySelector('iframe');
                if (iframe) {
                    console.log('Iframe found:', iframe.src);
                    iframe.contentWindow.postMessage({type: 'test'}, '*');
                } else {
                    console.log('No iframe found');
                }
            }

            // Call test function after page loads
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(testMapConnection, 2000);
            });

            console.log('Map communication script loaded');
</script>
</html>